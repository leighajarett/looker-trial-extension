"use strict";
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
const pick_1 = __importDefault(require("lodash/pick"));
const omit_1 = __importDefault(require("lodash/omit"));
const design_tokens_1 = require("@looker/design-tokens");
const react_1 = __importStar(require("react"));
const styled_components_1 = __importStar(require("styled-components"));
const InputProps_1 = require("../InputProps");
const Layout_1 = require("../../../Layout");
const Icon_1 = require("../../../Icon/Icon");
const Text_1 = require("../../../Text/Text");
const utils_1 = require("../../../utils");
const InputComponent = react_1.forwardRef((_a, forwardedRef) => {
    var { className, iconAfter, iconBefore, prefix, suffix, type = 'text', validationType } = _a, props = __rest(_a, ["className", "iconAfter", "iconBefore", "prefix", "suffix", "type", "validationType"]);
    if (iconBefore && prefix) {
        console.warn(`Only use IconBefore or prefix not both at the same time. `);
        return null;
    }
    if (iconAfter && suffix) {
        console.warn(`Only use IconAfter or suffix not both at the same time. `);
        return null;
    }
    const internalRef = react_1.useRef(null);
    const ref = utils_1.useForkedRef(internalRef, forwardedRef);
    const focusInput = () => internalRef.current && internalRef.current.focus();
    const before = iconBefore ? (react_1.default.createElement(exports.InputIconStyle, { paddingRight: "xsmall" },
        react_1.default.createElement(Icon_1.Icon, { name: iconBefore, size: 20 }))) : prefix ? (react_1.default.createElement(exports.InputIconStyle, { paddingRight: "xsmall" },
        react_1.default.createElement(Text_1.Text, { fontSize: "small" }, prefix))) : null;
    const after = iconAfter ? (react_1.default.createElement(exports.InputIconStyle, { paddingLeft: "xsmall" },
        react_1.default.createElement(Icon_1.Icon, { name: iconAfter, size: 20 }))) : suffix ? (react_1.default.createElement(exports.InputIconStyle, { paddingLeft: "xsmall" },
        react_1.default.createElement(Text_1.Text, { fontSize: "small" }, suffix))) : null;
    const inputProps = pick_1.default(omit_1.default(props, 'color', 'height', 'width'), InputProps_1.inputPropKeys);
    return (react_1.default.createElement(exports.InputLayout, { className: className, onClick: focusInput },
        before && before,
        react_1.default.createElement("input", Object.assign({}, inputProps, { "aria-invalid": validationType === 'error' ? 'true' : undefined, type: type, ref: ref })),
        after && after,
        validationType && (react_1.default.createElement(exports.InputIconStyle, { paddingLeft: "xsmall" },
            react_1.default.createElement(Icon_1.Icon, { color: "palette.red500", name: "Warning", size: 18 })))));
});
exports.inputTextHover = styled_components_1.css `
  border-color: ${(props) => props.theme.colors.palette.charcoal300};
`;
exports.inputTextFocus = styled_components_1.css `
  border-color: ${(props) => props.theme.colors.palette.purple300};
  box-shadow: 0 0 0 2px ${(props) => props.theme.colors.palette.purple100};
  outline: none;
`;
exports.inputTextDisabled = styled_components_1.css `
  background: ${(props) => props.theme.colors.palette.charcoal100};
  color: ${(props) => props.theme.colors.palette.charcoal400};
  &:hover {
    border-color: ${(props) => props.theme.colors.palette.charcoal200};
  }
`;
exports.inputHeight = '36px';
exports.InputLayout = styled_components_1.default.div.withConfig({ displayName: "InputLayout", componentId: "sc-pkti6j" }) `
  align-items: center;
  background-color: ${(props) => props.theme.colors.palette.white};
  display: inline-flex;
  height: ${exports.inputHeight};
  justify-content: space-evenly;

  input {
    border: none;
    background: transparent;
    flex: 1;
    font-size: ${(props) => props.theme.fontSizes.small};
    height: 100%;
    width: 100%;
    outline: none;
    padding: 0;
  }

  ::placeholder {
    color: ${(props) => props.theme.colors.palette.charcoal400};
  }

  &:hover {
    ${exports.inputTextHover}
  }
  &:focus,
  :focus-within {
    ${exports.inputTextFocus}
  }
`;
exports.InputIconStyle = styled_components_1.default(Layout_1.Flex).withConfig({ displayName: "InputIconStyle", componentId: "sc-nei863" }) `
  color: ${(props) => props.theme.colors.palette.charcoal400};
  pointer-events: none;
`;
exports.inputTextValidation = styled_components_1.css `
  ${(props) => props.validationType === 'error'
    ? `
      border-color: ${props.theme.colors.palette.red400};
      &:hover {
        border-color: ${props.theme.colors.palette.red500};
      }
      &:focus,
      :focus-within {
        border-color: ${props.theme.colors.palette.red500};
        box-shadow: 0 0 0 2px ${props.theme.colors.palette.red100};
      }
      `
    : ''}
`;
exports.InputText = styled_components_1.default(InputComponent).attrs((props) => {
    const padding = {
        px: props.px || props.p || 'small',
        py: props.py || props.p || 'none',
    };
    if (props.prefix || props.iconBefore) {
        padding.pl = 'xsmall';
    }
    if (props.suffix || props.iconAfter) {
        padding.pr = 'xsmall';
    }
    return padding;
}).withConfig({ displayName: "InputText", componentId: "sc-1htqid7" }) `
  ${design_tokens_1.reset}
  ${design_tokens_1.border}
  ${design_tokens_1.color}
  ${design_tokens_1.layout}
  ${design_tokens_1.space}
  ${design_tokens_1.typography}
  ${design_tokens_1.pseudoClasses}

  color: ${(props) => props.theme.colors.palette.charcoal700};

  ${(props) => (props.disabled ? exports.inputTextDisabled : '')}

  ${exports.inputTextValidation}
`;
exports.inputTextDefaults = {
    border: 'solid 1px',
    borderColor: 'palette.charcoal200',
    borderRadius: 'medium',
    fontSize: 'small',
    height: '36px',
    width: '100%',
};
exports.InputText.defaultProps = Object.assign(Object.assign({}, exports.inputTextDefaults), { type: 'text' });
InputComponent.displayName = 'InputComponent';
//# sourceMappingURL=InputText.js.map